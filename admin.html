<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>
<link rel="stylesheet" href="admin.css">
</head>
<body>

<div id="adminLogin">
  <h2>Admin Login</h2>
  <input id="adminPin" type="password" placeholder="Admin PIN">
  <button onclick="login()">Login</button>
  <p id="err"></p>
</div>

<div id="panel" class="hidden">
  <h2>Admin Dashboard</h2>
  <div id="users"></div>
</div>

<script>
const ADMIN_PIN="9999";
let users=JSON.parse(localStorage.getItem("users"))||[];

function login(){
  if(adminPin.value!==ADMIN_PIN){err.textContent="Wrong PIN";return;}
  adminLogin.style.display="none";
  panel.classList.remove("hidden");
  load();
}

function load(){
  usersDiv.innerHTML="";
  users.forEach((u,i)=>{
    usersDiv.innerHTML+=`
    <div class="card">
      <p><b>${u.name}</b></p>
      <p>${u.accountNumber}</p>
      <p>Status: ${u.frozen?"Frozen":"Active"}</p>
      <button onclick="toggle(${i})">${u.frozen?"Unfreeze":"Freeze"}</button>
      <p>Balance: $${u.balance}</p>
      <p>Transactions: ${u.transactions.length}</p>
      <textarea id="r${i}" placeholder="Reply"></textarea>
      <button onclick="reply(${i})">Send Reply</button>
    </div>`;
  });
}

function toggle(i){
  users[i].frozen=!users[i].frozen;
  localStorage.setItem("users",JSON.stringify(users));
  load();
}

function reply(i){
  const msg=users[i].messages.slice(-1)[0];
  if(msg) msg.reply=document.getElementById("r"+i).value;
  localStorage.setItem("users",JSON.stringify(users));
}
</script>

</body>
</html>
