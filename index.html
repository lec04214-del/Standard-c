<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Online Banking</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="index.css">
</head>
<body>

<!-- LOGIN -->
<div class="screen" id="loginScreen">
  <h2>User Login</h2>
  <input id="email" placeholder="Email">
  <input id="pin" type="password" placeholder="4-digit PIN">
  <button onclick="login()">Login</button>
  <p id="error"></p>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">

<header class="header">
  <h2>MyBank</h2>
  <button onclick="logout()">Logout</button>
</header>

<main class="content">

  <div class="card">
    <h3>Account Balance</h3>
    <strong id="balance">$0.00</strong>
  </div>

  <div class="card">
    <h3>Transactions</h3>
    <ul id="transactions"></ul>
  </div>

  <div class="card">
    <h3>Customer Service</h3>
    <textarea id="message" placeholder="Write your message..."></textarea>
    <button onclick="sendMessage()">Send</button>
    <p id="adminReply"></p>
  </div>

</main>
</div>

<script>
let users = JSON.parse(localStorage.getItem("users")) || [];
let currentUser = null;

function login(){
  currentUser = users.find(
    u => u.email === email.value && u.pin === pin.value
  );
  if(!currentUser){
    error.textContent = "Invalid login details";
    return;
  }
  loginScreen.style.display = "none";
  dashboard.classList.remove("hidden");
  render();
}

function render(){
  balance.textContent = "$" + currentUser.balance.toFixed(2);

  transactions.innerHTML = "";
  currentUser.transactions.forEach(t => {
    transactions.innerHTML += `<li>${t.type}: $${t.amount}</li>`;
  });

  const lastMessage = currentUser.messages.slice(-1)[0];
  adminReply.textContent = lastMessage?.reply || "";
}

function sendMessage(){
  if(!message.value) return;
  currentUser.messages.push({ text: message.value, reply: "" });
  save();
  message.value = "";
  alert("Message sent to support");
}

function save(){
  localStorage.setItem("users", JSON.stringify(users));
}

function logout(){
  location.reload();
}
</script>

</body>
</html>
